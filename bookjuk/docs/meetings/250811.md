# 📅 2025-08-11 회고

> **북적북적(BookJuk)** 프로젝트 좋아요 기능 구현 백엔드 작업 시작

## 🧭 오늘 논의한 주요 내용

* 기능 구현을 위한 깃허브 이슈 생성
* 좋아요 기능 구현을 위한 entity, dto, repository, service 코드 작성

## 🚩 내일 작업할 내용

* service 로직 이어서 작성, 테스트
* 마이페이지 기능 구현 작업 시작

---

## ✅ review(좋아요) 기능 구현 작업

### 설명
- meeting에 대한 reivew(좋아요) 를 남기는 기능 구현을 위한 작업입니다.
---

### 작업 범위
- [ ] meeting_review 테이블을 확인하여 review 엔터티를 생성합니다.
- [ ] review의 데이터 조회 및 조작을 담당하는 repository를 작성합니다.
- [ ] reveiw 기능에 대한 비즈니스 로직을 작성합니다. 

### 참고사항
- meeting_review 테이블은 모임 후기 및 좋아요 정보를 저장하며, reviewer_id와 reviewee_id를 통해 사용자 간 좋아요 관계를 표현합니다.
- 좋아요는 한 사용자가 같은 대상에게 중복으로 누를 수 없도록 처리해야 합니다.

---

## ✅ entity, dto, repository, service 코드 작성
테이블 ddl 문을 확인하여 entity를 작성하고   
```
@Entity
@Table(name = "meeting_review")

@Getter @ToString(exclude = {"meeting, user"})
@EqualsAndHashCode(of = "id")
@NoArgsConstructor(access = AccessLevel.PROTECTED)
public class MeetingReview {

    @Id
    @GeneratedValue(strategy = GenerationType.IDENTITY)
    private Long id;

    @ManyToOne(fetch = FetchType.LAZY)
    @JoinColumn(name = "meeting_id")
    private Meeting meeting;

    @ManyToOne(fetch = FetchType.LAZY)
    @JoinColumn(name = "reviewer_id")
    private User reviewer;

    @ManyToOne(fetch = FetchType.LAZY)
    @JoinColumn(name = "reviewee_id")
    private User reviewee;

    @CreationTimestamp
    @Column(nullable = false, updatable = false)
    private LocalDateTime createdAt;

}
```
리뷰와 유   

api 명세서를 토대로 요청, 응답 dto를 작성했다.
```
// request
public class ReviewRequest {

    // 좋아요를 받는 타켓 유저의 id
    private Long toUserId;
}

// response
public class ReviewResponse {

    private Long reviewId;
    private Long fromUserId;
    private Long toUserId;
    private LocalDateTime createdAt;

    // 엔터티를 dto로 바꾸는 정적 팩토리 메소드
    public static ReviewResponse from(MeetingReview review) {
        ReviewResponse response = ReviewResponse.builder()
                .reviewId(review.getId())
                // 유저 엔터티 생성 후 주석 제거
                /*
                .fromUserId(review.getReviewer().getId())
                .toUserId(review.getReviewee().getId())
                */
                .createdAt(review.getCreatedAt())
                .build();

        return response;
    }
}
```

service 와 repository는 user, meeting 과 관련된 코드 작성이 완료되면 추후 자세히 기술할 예정이다.   
service 에 작성할 좋아요 기능의 비즈니스 로직을 아래와 같이 정리했다.   

**좋아요 남기기(받기)**
1. 미팅 정보 확인
    - 미팅 id로 해당 미팅이 존재하는 지 확인
    - 미팅의 종료 여부를 확인한다.
    - 두 조건을 만족하면 유저 조건을 확인한다.
2.  유저 정보 확인
    - reviewer, reviewee가 미팅에 참여중인지 확인한다.
    - reviewer와 reivewee의 id가 서로 다른지 확인한다.
    - 두 조건을 만족하면 좋아요를 남길수(받을수) 있다.
3. 예외 발생 조건 확인
    - 존재하지 않은 미팅일 때
    - 종료되지 않은 미팅일 때
    - 미팅에 참여하지 않은 유저일 때
    - 리뷰를 남기는 유저와 받는 유저가 동일할 때
    - 중복으로 좋아요를 누르려고 할 때
    
---

## 💭 8/11 일 회고
드디어 백엔드 작업을 시작했다. 담당하는 작업들이(마이페이지, 좋아요) 앞선 작업이 필요한 작업들이라 아직 테스트는 해보지 못하지만, 그 시간 동안 비즈니스 로직을 작성하고 어떻게 요청과 응답 방식을 고민하면서 서비스 방향을 한 번 더 자세히 생각하고 정리할 수 있었다.   
또한 지난주에 작성했던 요구사항 명세서, api 명세서, 유저플로우 작성이 많이 도움되는 것을 느꼈다.   
