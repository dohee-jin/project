# 📅 2025-08-13 회고

> **북적북적(BookJuk)** 프로젝트 좋아요 기능 비즈니스 로직 작성, 테스트

## 🧭 오늘 논의한 주요 내용

* 좋아요 기능 구현을 위한 service 코드 작성 및 테스트

## 🚩 내일 작업할 내용

* 좋아요 기능 구현 컨트롤러 작성
* 마이페이지 기능 구현을 위한 dto, service 작업 시작

---

## ✅ 마이페이지 정보 응답 DTO 생성
마이페이지는 유저정보, 유저가 참여한(호스트, 참여자) 모임 정보, 통계 정보(참여 모임 수, 받은 좋아요 수)를 한번에 응답 받아야 하여 UserInfoDto, MeetingDto, StaticsInfoDto 3개와, 3개의 dto를 감쌀 MyPageResponse Dto를 생성했다. 
```
MyPageResponse dto
public class MyPageResponse {


    private UserInfoDto profile;
    private StaticsInfoDto statistics;
    private List<MeetingInfoDto> meetings;


    // 마이페이지 응답 dto로 바꾸는 정적 팩토리 메소드
    public static MyPageResponse of(UserInfoDto profile, StaticsInfoDto statistics, List<MeetingInfoDto> meetings) {

        return MyPageResponse.builder()
                .profile(profile)
                .statistics(statistics)
                .meetings(meetings)
                .build();
    }
}

UserInfoDto dto
public class UserInfoDto {

    // 유저 정보
    private String username;
    private String email;
    private String profileImage;
    private String preferredGenre;
    private String introduction;

    // 유저 객체를 MyPage 최상위 응답 dto로 보내기 위한 중간 정적 팩토리 메소드
    public static UserInfoDto from(User user) {
        return UserInfoDto.builder()
                .username(user.getUsername())
                .email(user.getEmail())
                .profileImage(user.getProfileImage())
                .preferredGenre(user.getPreferredGenre())
                .introduction(user.getIntroduction())
                .build();
    }
}

MeetingInfoDto dto
public class MeetingInfoDto {

    // 모임 정보
    private Long meetingId;
    private String meetingTitle;
    private LocalDateTime meetingTime;
    private MeetingStatus meetingStatus;
    private ParticipantRole role;
    private Map<String, String> book;

    public static MeetingInfoDto from(MeetingParticipant meetingParticipant) {
        Meeting meeting = meetingParticipant.getMeeting();

        Map<String, String> bookMap = new HashMap<>();
        bookMap.put("title", meeting.getBookTitle());
        bookMap.put("author", meeting.getBookAuthor());

        return MeetingInfoDto.builder()
                .meetingId(meeting.getId())
                .meetingTitle(meeting.getTitle())
                .meetingTime(meeting.getMeetingTime())
                .meetingStatus(meeting.getMeetingStatus())
                .role(meetingParticipant.getRole())
                .book(bookMap)
                .build();

    }
}

StaticsInfoDto dto
public class StaticsInfoDto {

    private Long receivedLikes;
    private int participatedMeeting;

    public static StaticsInfoDto of(Long likes, int meetings) {
        return StaticsInfoDto.builder()
                .receivedLikes(likes)
                .participatedMeeting(meetings)
                .build();
    }

}
```

## ✅ 마이페이지 service 비즈니스 로직 작성

---

## 💭 8/13 일 회고
mypage에서 받아야 되는 정보 존나 많은데 일단 어케해야 될지 모르겠음
그리고 그 book 정보를 미팅 테이블에서 받아오는데 api 명세서는 객체여서 
맵으로 받게함 맵으로 받는데? 또 dto 팩토리 메소드 안에서 map을 또 선언해야 됐음
ㄹㅇ,,> 이걸 리스트로 선언해서 맵을 받아야 되나 했지만 미팅 당 책 정보는 하나니까 
리스트로 받는게 이상함 그래서 다시 맵으로 받음 book이라는 큰 맵안에 북 맵에 정보를 하나씩 넣음
그러니까 에러가 안떴음 암튼 어케 해결함... 클로드야 고마워~~~~
아 장르도 여러개 설정해서 리스트로 받아야 되나 고민했는데 동준님한테 물어보니까 하나만 설정할 수 있게 하셨다고
하셔서 일단 그냥 스트링으로 처리함 

추후 추가되면 좋을 정보
책 관련 기능을 추가하면서 북 객체를 생성하는 게 좋아보임
북 객체로 관리하면 더 기능이 깔끔해질 것 같음!
선호장르 테이블도 생성해서 관리하면 좋을 것 같음
