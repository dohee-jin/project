# ğŸ“… 2025-09-17

> **íŠ¸ë¡œí”¼ì¹¼** í”„ë¡œì íŠ¸

## ğŸ§­ ì˜¤ëŠ˜ ì‘ì—…í•œ ì£¼ìš” ë‚´ìš©

* AI ìŠ¤ëª°í† í¬ ì£¼ì œ ìƒì„± ê¸°ëŠ¥ ê°œë°œ (BE)
    * spring ai ì‚¬ìš© ì„¤ì •
    * í”„ë¡ íŠ¸ì—”ë“œ ì‘ë‹µ DTO ìƒì„±
    * AI <-> ë°±ì—”ë“œ ìš”ì²­ dto, ì‘ë‹µ dto ìƒì„±

## ğŸš© ë‚´ì¼ ì‘ì—…í•  ë‚´ìš©

* AI ìŠ¤ëª°í† í¬ ì£¼ì œ ìƒì„± ê¸°ëŠ¥ ê°œë°œ (BE)
    * AI ìŠ¤ëª°í† í¬ ì£¼ì œ ìƒì„± ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§ ì‘ì„±

---

## âœ… AI ìŠ¤ëª°í† í¬ ì£¼ì œ ìƒì„± ê¸°ëŠ¥ ê°œë°œ (BE)

* **Spring ai ì‚¬ìš© ì„¤ì •**
    * build.gradle ì„¤ì •   
    Spring AI ì‚¬ìš©ì„ ìœ„í•´ build.gradleì— ì˜ì¡´ì„± ì„¤ì •ì„ ì¶”ê°€í–ˆë‹¤.   
    ```
    ext {
        set('springAiVersion', '1.0.0-M5')
    }
    repositories {
        // ì¤‘ì•™ ì €ì¥ì†Œ ì‚¬ìš©(íšŒì‚¬ Nexus/Artifactory ì—†ì„ ë•Œ ê¸°ë³¸)
        mavenCentral()
        maven { url 'https://repo.spring.io/milestone' }
    }
    dependencies {
        implementation "org.springframework.ai:spring-ai-openai-spring-boot-starter:${springAiVersion}" 
    }
    ```

    * application.yml ì„¤ì •
    ```
    spring: 
        ai:
            openai:
            base-url: https://generativelanguage.googleapis.com/v1beta/openai/
            api-key: ${GEMINI_API_KEY}
            chat:
                completions-path: /chat/completions
                options:
                model: ${GEMINI_MODEL}
                temperature: 0.2
                max-tokens: 1024
            retry:
            on-client-errors: true
            on-http-codes: 429,503
            initial-interval: 500ms
            max-attempts: 3
    ```

    * .env íŒŒì¼ì— AI key, model ê°’ ì¶”ê°€

* **í”„ë¡ íŠ¸ì—”ë“œ ì‘ë‹µ DTO ìƒì„±**   
    dbì— ì €ì¥ëœ ìŠ¤ëª°í† í¬ ì£¼ì œë¥¼ í”„ë¡ íŠ¸ì—”ë“œë¡œ ë¿Œë¦¬ê¸° ìœ„í•œ í”„ë¡ íŠ¸ì—”ë“œìš© ì‘ë‹µ dto ìƒì„±   
    ë ˆì½”ë“œë¥¼ ì‚¬ìš©í•˜ì—¬ dtoë¥¼ ë§Œë“¤ì—ˆë‹¤.
    ``` SmallTalkTopicDto
    public record SmallTalkTopicDto(
            Long id,
            String topicType,
            String topicContent,
            String exampleQuestion,
            List<SmalltalkSourcesDto> sources
    ) {

        public static SmallTalkTopicDto from(SmalltalkTopic topic,
                                            List<SmalltalkSourcesDto> sources) {
            return new SmallTalkTopicDto(
                    topic.getId(),
                    topic.getTopicType(),
                    topic.getTopicContent(),
                    topic.getExampleQuestion(),
                    sources
            );
        }
    }
    ```
    ```SmallTalkSourceDto
    public record SmalltalkSourcesDto(
        Long sourceId,
        String sourceType
    ) {
        public static SmalltalkSourcesDto from(SmalltalkSources sources) {
            return new SmalltalkSourcesDto(
                    sources.getSourceId(),
                    sources.getSourceType().name()
            );
        }
    }
    ```

* **AI <-> ë°±ì—”ë“œ ìš”ì²­/ì‘ë‹µ DTO ìƒì„±**   
    AI ìš”ì²­/ì‘ë‹µì„ dtoë¡œ í†µì¼í•˜ì—¬ ëª…í™•í•œ ë°ì´í„° íë¦„ì„ ë§Œë“¤ì—ˆë‹¤.      

    AI ìš”ì²­ dto ëŠ” ì‚¬ìš©ìì˜ í™œë™ ê¸°ë¡ í•˜ë‚˜ë¥¼ ë‹´ì„ ActivityDtoì™€ ActivityDtoë¥¼ ë¬¶ì–´ AIì—ê²Œ ì „ë‹¬í•˜ëŠ” TopicGenerateRequest Dto ë¡œ êµ¬ì„±í–ˆë‹¤.
    ```ActivityDto
    public record ActivityDto(
            Long id,
            String title,
            String content,
            LocalDateTime createdAt
    ) {
    }
    ``` 
    ```TopicGenerateRequest
    public record TopicGenerateRequest (
        int topicCount,
        Map<SourceType, List<ActivityDto>> activities //
    ) {
    }
    ```   

    AI ì‘ë‹µ dtoëŠ” db êµ¬ì¡°ì— ë§ê²Œ Source ì •ë³´ë¥¼ ë°›ì„ dtoì™€ Source ì •ë³´ë¥¼ í¬í•¨í•œ ì „ì²´ dtoë¡œ êµ¬ì„±í–ˆë‹¤.
    ```AISourceDto
    public record AISourceDto(
            Long sourceId,
            SourceType sourceType
    ) {
    }
    ```
    ```AISmallTalkResponse
    public record AISmallTalkResponse(
        String topicType,
        String topicContent,
        String exampleQuestion,
        List<Double> embedding,
        List<AISourceDto> sources

    ) {
    }
    ```
---

## ğŸ’­ 9/17 ì¼ íšŒê³    
DB êµ¬ì¡°ë¥¼ ê¸°ë°˜ìœ¼ë¡œ AI ì£¼ì œ ìƒì„± ë¡œì§ì— í•„ìš”í•œ ìš”ì²­/ì‘ë‹µ DTOë¥¼ ë¨¼ì € ì‘ì„±í–ˆë‹¤. ë ˆì½”ë“œë¥¼ í™œìš©í•´ ê¸°ì¡´ í´ë˜ìŠ¤ ë°©ì‹ë³´ë‹¤ ì½”ë“œê°€ ê°„ê²°í•´ì§€ê³  ë¶ˆí•„ìš”í•œ ë³´ì¼ëŸ¬í”Œë ˆì´íŠ¸ê°€ ì¤„ì–´ë“œëŠ” ê²ƒì„ ì²´ê°í•  ìˆ˜ ìˆì—ˆë‹¤. AIì™€ì˜ ì—°ê²°ì€ ê¸°ì¡´ RestTemplate, WebClient ëŒ€ì‹  Spring AIë¥¼ ì±„íƒí•˜ì—¬ ìµœì‹  ê¸°ìˆ ì„ ê²½í—˜í•˜ë©° ê°œë°œí•  ê³„íšì´ë‹¤. ì´ë²ˆ ê²½í—˜ì„ í†µí•´ ì„¤ê³„ ë‹¨ê³„ì—ì„œ DTO êµ¬ì¡°ë¥¼ ì˜ ì¡ëŠ” ê²ƒì´ í›„ì† êµ¬í˜„ì˜ íš¨ìœ¨ì„±ì„ í¬ê²Œ ë†’ì¸ë‹¤ëŠ” ì ì„ ë°°ì› ë‹¤.